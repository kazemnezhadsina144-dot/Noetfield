<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Noetfield – Partner Intake (Routing)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="description" content="90-second partner intake for Noetfield. Create a Request ID, submit non-confidential basics, and route to a lane-specific partner application: Delivery, Channel, or Integration." />
  <meta name="robots" content="index,follow" />
  <meta name="author" content="Noetfield Systems Inc." />
  <link rel="canonical" href="https://www.noetfield.com/gate/partners/intake/" />

  <link rel="icon" href="/noetfield-favicon-512.png" type="image/png" />
  <link rel="apple-touch-icon" href="/noetfield-favicon-512.png" />
  <meta name="theme-color" content="#07070b" />

  <!-- OG -->
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Noetfield" />
  <meta property="og:title" content="Noetfield – Partner Intake (Routing)" />
  <meta property="og:description" content="Submit non-confidential basics and route to a lane-specific partner application: Delivery, Channel, or Integration." />
  <meta property="og:url" content="https://www.noetfield.com/gate/partners/intake/" />
  <meta property="og:image" content="https://www.noetfield.com/noetfield-og.png" />

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Noetfield – Partner Intake (Routing)" />
  <meta name="twitter:description" content="Submit non-confidential basics and route to a lane-specific partner application: Delivery, Channel, or Integration." />
  <meta name="twitter:image" content="https://www.noetfield.com/noetfield-og.png" />

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />

  <style>
    :root{
      --bg0:#07070b; --bg1:#0b0b14;
      --text:#eff0f7; --muted:#b9bbcf; --muted2:#8e91ad;
      --gold:#c8a349;
      --ok:#2de38a; --okGlow: rgba(45,227,138,.18);
      --danger:#ff5a5a;
      --radius:18px; --max:1120px;
      --shadow: 0 28px 80px rgba(0,0,0,.62);
      --shadow2: 0 14px 50px rgba(0,0,0,.50);
      --focus: 0 0 0 4px rgba(200,163,73,.18);
      --navH: 68px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color: var(--text);
      background: linear-gradient(180deg, var(--bg0), var(--bg1));
      overflow-x:hidden;
      -webkit-font-smoothing: antialiased;
      text-rendering: optimizeLegibility;
    }
    a{color:inherit; text-decoration:none}
    a:focus-visible, button:focus-visible, input:focus-visible, select:focus-visible, textarea:focus-visible{
      outline:none; box-shadow: var(--focus);
      border-color: rgba(200,163,73,.58) !important;
    }
    [hidden]{display:none !important;}

    .bg{
      position:fixed; inset:0; z-index:-3; pointer-events:none;
      background:
        radial-gradient(1400px 820px at 10% -10%, rgba(200,163,73,.20), transparent 58%),
        radial-gradient(1200px 820px at 100% 0%, rgba(122,167,255,.12), transparent 60%),
        radial-gradient(900px 700px at 55% 22%, rgba(255,255,255,.05), transparent 62%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
    }
    .bg::before{
      content:""; position:absolute; inset:0;
      background:
        linear-gradient(rgba(255,255,255,.05) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255,255,255,.04) 1px, transparent 1px);
      background-size: 54px 54px;
      opacity:.055;
      mask-image: radial-gradient(70% 60% at 50% 8%, black 55%, transparent 100%);
    }
    .bg::after{
      content:""; position:absolute; inset:-90px;
      background:
        radial-gradient(1100px 760px at 50% 8%, transparent 55%, rgba(0,0,0,.58) 100%),
        radial-gradient(1000px 900px at 50% 110%, rgba(0,0,0,.68), transparent 62%);
      opacity:.92;
    }

    .wrap{max-width:var(--max); margin:0 auto; padding:24px}

    header{
      position:sticky; top:0; z-index:60;
      backdrop-filter: blur(16px);
      background: rgba(8,8,12,.62);
      border-bottom: 1px solid rgba(255,255,255,.10);
    }
    .nav{
      max-width:var(--max); margin:0 auto;
      padding: 10px 16px;
      display:flex; align-items:center; justify-content:space-between;
      gap:14px; min-height: var(--navH);
    }
    .brand{display:flex; align-items:center; gap:12px; min-width:240px}
    .brandMark{
      width:36px; height:36px; border-radius:12px;
      border:1px solid rgba(255,255,255,.12);
      box-shadow: 0 12px 26px rgba(0,0,0,.55);
    }
    .brand .name{font-weight:800; font-size:15px; line-height:1.05}
    .brand .tag{
      font-size:10.5px; color:var(--muted2);
      margin-top:3px; letter-spacing:.28em;
      text-transform:uppercase;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
      max-width: 320px;
    }

    /* Desktop menu */
    .menu{display:flex; align-items:center; gap:12px; flex:1 1 auto}
    .menuPrimary, .menuActions{display:flex; align-items:center; gap:8px; flex-wrap:nowrap}
    .menuPrimary{flex:1 1 auto; justify-content:center; overflow:hidden}
    .menuActions{flex:0 0 auto; justify-content:flex-end}

    .menu a{
      color:var(--muted);
      padding:8px 10px;
      border-radius:14px;
      border:1px solid transparent;
      transition: background .15s ease, border-color .15s ease, color .15s ease;
      white-space:nowrap; font-size:12.75px; line-height:1;
    }
    .menu a:hover{
      color:var(--text);
      border-color:rgba(255,255,255,.10);
      background:rgba(255,255,255,.045);
    }
    .menu a.active, .menu a[aria-current="page"]{
      color:var(--text);
      border-color:rgba(200,163,73,.38);
      background:
        radial-gradient(240px 90px at 50% 0%, rgba(255,255,255,.10), transparent 60%),
        linear-gradient(180deg, rgba(200,163,73,.22), rgba(200,163,73,.10));
    }
    .menu a.pilltab{
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.03);
    }
    .menu a.login{
      border:1px solid rgba(200,163,73,.58);
      background:
        radial-gradient(220px 90px at 40% 0%, rgba(255,255,255,.11), transparent 62%),
        linear-gradient(180deg, rgba(200,163,73,.22), rgba(200,163,73,.10));
      color: var(--text);
      font-weight:750;
      padding:8px 11px;
    }
    .menu a.statusLink{display:inline-flex; align-items:center; gap:8px}
    .statusDot{
      width:7px; height:7px; border-radius:50%;
      background: var(--ok);
      box-shadow: 0 0 0 3px var(--okGlow);
    }

    /* Mobile */
    .burger{display:none; width:42px; height:42px; border-radius:14px; border:1px solid rgba(255,255,255,.12); background: rgba(255,255,255,.04); cursor:pointer}
    .burger svg{width:20px; height:20px; opacity:.92}
    .mobilePanel{border-top:1px solid rgba(255,255,255,.10); background: rgba(8,8,12,.74); backdrop-filter: blur(16px)}
    .mobileInner{max-width:var(--max); margin:0 auto; padding: 12px 14px 16px}
    .mobileGrid{display:grid; grid-template-columns:1fr 1fr; gap:10px}
    .mobileGrid a{
      padding:12px 12px; border-radius:16px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
      color: var(--muted);
      font-size:14px;
      display:flex; align-items:center; justify-content:center; gap:8px;
      text-align:center;
    }
    .mobileGrid a.active, .mobileGrid a[aria-current="page"]{
      color: var(--text);
      border-color: rgba(200,163,73,.42);
      background:
        radial-gradient(220px 90px at 30% 0%, rgba(200,163,73,.22), transparent 60%),
        rgba(200,163,73,.10);
    }

    .hero{padding: 22px 0 12px}
    .heroShell{
      border-radius: calc(var(--radius) + 8px);
      border: 1px solid rgba(255,255,255,.11);
      background:
        radial-gradient(1000px 420px at 18% 0%, rgba(200,163,73,.18), transparent 60%),
        radial-gradient(1000px 420px at 90% 10%, rgba(122,167,255,.10), transparent 62%),
        linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.022));
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .heroInner{padding: 24px 22px}
    .eyebrow{
      display:inline-flex; gap:10px; align-items:center;
      color:var(--muted);
      font-size:13px;
      padding:9px 12px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.13);
      background: rgba(255,255,255,.035);
    }
    .dot{
      width:8px; height:8px; border-radius:50%;
      background: rgba(200,163,73,.97);
      box-shadow: 0 0 0 3px rgba(200,163,73,.18);
    }
    h1{margin:14px 0 10px; font-size:40px; line-height:1.07; letter-spacing:-0.75px}
    .lead{margin:0; color:var(--muted); font-size:16px; max-width: 920px}

    .grid{display:grid; grid-template-columns: 1.15fr .85fr; gap:18px; margin: 18px 0 34px}
    .card{
      border-radius:var(--radius);
      border:1px solid rgba(255,255,255,.11);
      background: linear-gradient(180deg, rgba(255,255,255,.055), rgba(255,255,255,.022));
      box-shadow: var(--shadow2);
      overflow:hidden;
    }
    .card .hd{padding:18px 18px 0}
    .card h2{margin:0 0 8px; font-size:18px}
    .card p{margin:0 0 12px; color:var(--muted)}
    .card .bd{padding:18px}

    .ridBar{
      margin-top:12px;
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      padding:12px 12px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
    }
    .ridLabel{font-size:11px; letter-spacing:.28em; text-transform:uppercase; color:var(--muted2)}
    .ridValue{font-weight:700; color:var(--text); font-size:13px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width:520px}
    .ridActions{display:flex; gap:8px; align-items:center; flex-wrap:wrap}
    .miniBtn{
      font-size:13px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.04);
      padding:9px 12px;
      border-radius:14px;
      cursor:pointer;
      display:inline-flex; align-items:center; justify-content:center; gap:8px;
    }
    .miniBtn.primary{border-color: rgba(200,163,73,.38); background: rgba(200,163,73,.10)}

    .form{display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-top:12px}
    .form .full{grid-column:1 / -1}
    label{display:block; font-size:12px; color:var(--muted2); margin:0 0 6px}
    input, select, textarea{
      width:100%;
      background: rgba(10,10,16,.55);
      border: 1px solid rgba(255,255,255,.14);
      color: var(--text);
      padding: 12px 12px;
      border-radius: 14px;
      font-family:inherit;
      font-size:14px;
    }
    textarea{min-height:110px; resize:vertical}
    .actions{display:flex; gap:12px; align-items:center; margin-top:12px; flex-wrap:wrap}
    .btn{
      display:inline-flex; align-items:center; justify-content:center;
      gap:10px; padding:12px 14px;
      border-radius:16px;
      border:1px solid rgba(200,163,73,.58);
      background:
        radial-gradient(260px 110px at 40% 0%, rgba(255,255,255,.11), transparent 62%),
        linear-gradient(180deg, rgba(200,163,73,.24), rgba(200,163,73,.11));
      color:var(--text); font-weight:800; font-size:14px; cursor:pointer;
    }
    .btn.secondary{
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.04);
      font-weight:650; color: var(--muted);
    }
    .formMsg{
      margin-top:12px;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.03);
      color: var(--muted);
      font-size:12px;
      line-height:1.55;
      display:none;
    }
    .box{
      margin-top:14px;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      color: var(--muted2);
      font-size:12px;
      line-height:1.6;
    }
    .box strong{color:var(--text); font-weight:650}

    footer{
      border-top:1px solid rgba(255,255,255,.10);
      padding: 18px 0 22px;
      color:var(--muted2);
      margin-top:34px;
      background: rgba(8,8,12,.35);
      backdrop-filter: blur(10px);
    }
    .foot{max-width:var(--max); margin:0 auto; padding: 0 16px; display:flex; flex-wrap:wrap; gap:12px 18px; align-items:center; justify-content:space-between}
    .footBrand{display:flex; align-items:center; gap:10px; color:var(--muted)}
    .footBrand img{width:28px; height:28px; border-radius:10px; border:1px solid rgba(255,255,255,.12); background: rgba(255,255,255,.03)}
    .footNav{display:flex; flex-wrap:wrap; gap:10px 12px; align-items:center}
    .footNav a{
      color: var(--muted);
      padding:8px 10px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      font-size:13px;
      white-space:nowrap;
    }
    .statusLink{display:inline-flex; align-items:center; gap:8px}

    @media (max-width: 1140px){ .menu{display:none} .burger{display:flex} }
    @media (max-width: 980px){ .grid{grid-template-columns:1fr} .ridValue{max-width:100%} }
    @media (max-width: 760px){
      :root{--navH: 64px}
      .wrap{padding:16px}
      .brand .tag{display:none}
      h1{font-size:30px}
      .form{grid-template-columns:1fr}
      .mobileGrid{grid-template-columns:1fr 1fr}
      .ridBar{flex-direction:column; align-items:flex-start}
    }
    @media (max-width: 420px){ .mobileGrid{grid-template-columns:1fr} }
  </style>

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebPage",
    "name": "Noetfield Partner Intake (Routing)",
    "url": "https://www.noetfield.com/gate/partners/intake/",
    "description": "90-second partner intake for Noetfield. Create a Request ID, submit non-confidential basics, and route to a lane-specific partner application: Delivery, Channel, or Integration.",
    "isPartOf": {"@type":"WebSite","name":"Noetfield","url":"https://www.noetfield.com/"},
    "publisher": {"@type":"Organization","name":"Noetfield Systems Inc."}
  }
  </script>
</head>

<body>
  <div class="bg" aria-hidden="true"></div>

  <header>
    <div class="nav">
      <a class="brand" href="/" aria-label="Noetfield home">
        <img class="brandMark" src="/noetfield-favicon-512.png" alt="Noetfield mark" />
        <div>
          <div class="name">Noetfield</div>
          <div class="tag">Trust and Stewardship in AI</div>
        </div>
      </a>

      <nav class="menu" aria-label="Primary navigation">
        <div class="menuPrimary" aria-label="Core">
          <a href="/trust-ledger/">Trust Ledger</a>
          <a href="/trust-brief/">Trust Brief</a>
          <a href="/playbook/">Playbook</a>
          <a href="/copilot-cost-governance/">Copilot</a>
          <a href="/for-whom/">For Whom</a>
        </div>
        <div class="menuActions" aria-label="App actions">
          <a class="pilltab" href="/gate/">Gate</a>
          <a class="pilltab" href="/portal/">Portal</a>
          <a class="pilltab statusLink" href="/status/"><span class="statusDot" aria-hidden="true"></span>Status</a>
          <a class="login" href="/portal/login/">Login</a>
        </div>
      </nav>

      <button class="burger" id="burger" aria-label="Open menu" aria-expanded="false" aria-controls="mobilePanel">
        <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M4 7h16M4 12h16M4 17h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </button>
    </div>

    <div class="mobilePanel" id="mobilePanel" hidden>
      <div class="mobileInner">
        <div class="mobileGrid" aria-label="Mobile navigation">
          <a href="/trust-ledger/">Trust Ledger</a>
          <a href="/trust-brief/">Trust Brief</a>
          <a href="/playbook/">Playbook</a>
          <a href="/copilot-cost-governance/">Copilot</a>
          <a href="/for-whom/">For Whom</a>
          <a href="/gate/">Gate</a>
          <a href="/portal/">Portal</a>
          <a class="statusLink" href="/status/"><span class="statusDot" aria-hidden="true"></span>Status</a>
          <a href="/portal/login/">Login</a>
        </div>
      </div>
    </div>
  </header>

  <main class="wrap">
    <section class="hero">
      <div class="heroShell">
        <div class="heroInner">
          <div class="eyebrow"><span class="dot"></span> 90-second intake • Request ID • lane routing</div>
          <h1>Partner intake (routing).</h1>
          <p class="lead">
            Submit non-confidential basics. You will be routed to a lane-specific, decisive application:
            <strong>Delivery</strong>, <strong>Channel</strong>, or <strong>Integration</strong>.
          </p>
        </div>
      </div>
    </section>

    <section class="grid">
      <div class="card">
        <div class="hd">
          <h2>Intake</h2>
          <p>Short, clean, reviewable. Links only. No confidential data.</p>

          <div class="ridBar" aria-label="Request ID bar">
            <div>
              <div class="ridLabel">Request ID</div>
              <div class="ridValue" id="ridText">—</div>
            </div>
            <div class="ridActions">
              <button class="miniBtn" type="button" id="copyRidBtn">Copy</button>
              <a class="miniBtn primary" id="openStatusBtn" href="/status/">Open Status</a>
            </div>
          </div>
        </div>

        <div class="bd">
          <form id="nfPartnerIntakeForm" action="https://formspree.io/f/YOUR_FORM_ID" method="POST" novalidate>
            <input type="hidden" name="page_source" value="/gate/partners/intake/" />
            <input type="hidden" name="source" value="gate-partners-intake" />
            <input type="hidden" name="site" value="noetfield.com" />
            <input type="hidden" name="_subject" value="Noetfield Gate — Partner Intake (Routing)" />
            <input type="hidden" id="request_id" name="request_id" value="" />
            <input type="text" name="_gotcha" style="display:none" tabindex="-1" autocomplete="off" aria-hidden="true" />

            <div class="form">
              <div>
                <label for="fullName">Full name</label>
                <input id="fullName" name="fullName" type="text" autocomplete="name" placeholder="First + last" required />
              </div>

              <div>
                <label for="email">Work email</label>
                <input id="email" name="email" type="email" autocomplete="email" placeholder="name@company.com" required />
              </div>

              <div>
                <label for="org">Organization</label>
                <input id="org" name="organization" type="text" autocomplete="organization" placeholder="Company / firm / independent" required />
              </div>

              <div>
                <label for="website">Website / LinkedIn</label>
                <input id="website" name="website" type="url" placeholder="https://…" />
              </div>

              <div class="full">
                <label for="lane">Lane (routing)</label>
                <select id="lane" name="lane" required>
                  <option value="" disabled selected>Select one</option>
                  <option value="delivery">Delivery partner</option>
                  <option value="channel">Channel / referral partner</option>
                  <option value="integration">Integration / security partner</option>
                </select>
              </div>

              <div class="full">
                <label for="fit">One-line fit (non-confidential)</label>
                <input id="fit" name="fit" type="text" placeholder="Example: M365/Copilot governance for BC mid-market; board memo + controls delivery." required />
              </div>

              <div class="full">
                <label style="display:flex; gap:10px; align-items:flex-start;">
                  <input type="checkbox" name="non_confidential_ack" value="yes" required style="width:auto; margin-top:3px;" />
                  <span style="color: var(--muted); font-size:13px; line-height:1.45;">
                    I confirm this submission is <strong>high-level, non-confidential</strong>. If we proceed, Noetfield will propose a safer channel.
                    <span style="display:block; margin-top:6px; font-size:12px; color: var(--muted2);">
                      See: <a href="/privacy/" style="border-bottom:1px solid rgba(255,255,255,.18)">Privacy</a>
                    </span>
                  </span>
                </label>
              </div>
            </div>

            <div class="actions">
              <button class="btn" id="submitBtn" type="submit">Submit intake & route</button>
              <a class="btn secondary" href="/gate/partners/">Back to Partners</a>
            </div>

            <div id="formMsg" class="formMsg" role="status" aria-live="polite"></div>
          </form>
        </div>
      </div>

      <aside class="card">
        <div class="hd">
          <h2>What happens next</h2>
          <p>Fast routing, then a decisive lane form.</p>
        </div>
        <div class="bd">
          <div class="box"><strong>1) Submit intake.</strong> You receive a Request ID.</div>
          <div class="box"><strong>2) Auto-route.</strong> You land on the lane page (Delivery / Channel / Integration).</div>
          <div class="box"><strong>3) Complete lane form.</strong> Longer, decisive, proof-based.</div>
          <div class="box"><strong>4) Review.</strong> If aligned, we propose safer channels + scoped pilot.</div>

          <div class="box" style="margin-top:14px;">
            <strong>Direct lanes:</strong><br/>
            <a href="/gate/partners/delivery/" style="border-bottom:1px solid rgba(255,255,255,.18)">Delivery</a> ·
            <a href="/gate/partners/channel/" style="border-bottom:1px solid rgba(255,255,255,.18)">Channel</a> ·
            <a href="/gate/partners/integration/" style="border-bottom:1px solid rgba(255,255,255,.18)">Integration</a>
          </div>
        </div>
      </aside>
    </section>

    <footer>
      <div class="foot">
        <a class="footBrand" href="/" aria-label="Noetfield home">
          <img src="/noetfield-favicon-512.png" alt="Noetfield mark" />
          <span>© <span id="y"></span> Noetfield Systems Inc.</span>
        </a>
        <div class="footNav" aria-label="Footer navigation">
          <a href="/trust-ledger/">Trust Ledger</a>
          <a href="/trust-brief/">Trust Brief</a>
          <a href="/playbook/">Playbook</a>
          <a href="/copilot-cost-governance/">Copilot</a>
          <a href="/for-whom/">For Whom</a>
          <a href="/gate/">Gate</a>
          <a href="/portal/">Portal</a>
          <a class="statusLink" href="/status/"><span class="statusDot" aria-hidden="true"></span>Status</a>
          <a href="/feedback/">Feedback</a>
          <a href="/contact/">Contact</a>
          <a href="/privacy/">Privacy</a>
          <a href="/terms/">Terms</a>
        </div>
      </div>
    </footer>
  </main>

  <script>
    document.getElementById("y").textContent = new Date().getFullYear();

    (function () {
      var burger = document.getElementById("burger");
      var panel = document.getElementById("mobilePanel");
      if (!burger || !panel) return;
      burger.addEventListener("click", function () {
        var isOpen = burger.getAttribute("aria-expanded") === "true";
        burger.setAttribute("aria-expanded", String(!isOpen));
        panel.hidden = isOpen;
      });
      document.addEventListener("keydown", function (e) {
        if (e.key === "Escape" && burger.getAttribute("aria-expanded") === "true") {
          burger.setAttribute("aria-expanded", "false");
          panel.hidden = true;
        }
      });
    })();

    // RID: from URL ?rid=, else localStorage, else generate (and persist)
    (function () {
      var ridInput = document.getElementById("request_id");
      var ridText = document.getElementById("ridText");
      var openStatusBtn = document.getElementById("openStatusBtn");
      if (!ridInput || !ridText) return;

      function getParam(name){
        try { return new URLSearchParams(window.location.search).get(name) || ""; } catch(e){ return ""; }
      }
      function rand4() { return Math.floor(Math.random() * 10000).toString().padStart(4, "0"); }
      function genRID(){
        var d = new Date();
        var stamp = d.getUTCFullYear().toString()
          + String(d.getUTCMonth()+1).padStart(2,"0")
          + String(d.getUTCDate()).padStart(2,"0")
          + "-"
          + String(d.getUTCHours()).padStart(2,"0")
          + String(d.getUTCMinutes()).padStart(2,"0")
          + String(d.getUTCSeconds()).padStart(2,"0");
        return "NF-PI-" + stamp + "-" + rand4();
      }

      var rid = getParam("rid");
      if (!rid) { try { rid = localStorage.getItem("nf_partner_rid") || ""; } catch(e){} }
      if (!rid) rid = genRID();

      ridInput.value = rid;
      ridText.textContent = rid;

      try { localStorage.setItem("nf_partner_rid", rid); } catch(e){}
      if (openStatusBtn) openStatusBtn.href = "/status/?rid=" + encodeURIComponent(rid);

      var copyBtn = document.getElementById("copyRidBtn");
      if (copyBtn) {
        copyBtn.addEventListener("click", async function(){
          try{
            await navigator.clipboard.writeText(rid);
            copyBtn.textContent = "Copied";
            setTimeout(function(){ copyBtn.textContent = "Copy"; }, 1200);
          } catch(e){}
        });
      }

      // Append RID to internal links on this page
      var links = document.querySelectorAll('a[href^="/"]');
      links.forEach(function(a){
        var href = a.getAttribute("href") || "";
        if (!href.startsWith("/")) return;
        if (href.startsWith("/status/")) return; // already handled
        if (href.indexOf("?") !== -1) return; // leave existing queries
        if (!rid) return;
        a.setAttribute("href", href + "?rid=" + encodeURIComponent(rid));
      });
    })();

    // Form submit + routing
    (function () {
      var form = document.getElementById("nfPartnerIntakeForm");
      if (!form) return;

      var msg = document.getElementById("formMsg");
      var btn = document.getElementById("submitBtn");
      var ridInput = document.getElementById("request_id");

      function setMsg(text, kind){
        if (!msg) return;
        msg.style.display = "block";
        msg.textContent = text;
        if (kind === "ok") {
          msg.style.borderColor = "rgba(45,227,138,.25)";
          msg.style.background = "rgba(45,227,138,.06)";
        } else if (kind === "err") {
          msg.style.borderColor = "rgba(255,90,90,.25)";
          msg.style.background = "rgba(255,90,90,.06)";
        } else {
          msg.style.borderColor = "rgba(255,255,255,.12)";
          msg.style.background = "rgba(255,255,255,.03)";
        }
      }

      function routeByLane(lane, rid){
        lane = (lane || "").toLowerCase();
        var target = "/gate/partners/";
        if (lane === "delivery") target = "/gate/partners/delivery/";
        if (lane === "channel") target = "/gate/partners/channel/";
        if (lane === "integration") target = "/gate/partners/integration/";
        var url = target;
        if (rid) url += "?rid=" + encodeURIComponent(rid);
        window.location.assign(url);
      }

      form.addEventListener("submit", async function (e) {
        e.preventDefault();
        var action = form.getAttribute("action");
        if (!action || action.indexOf("YOUR_FORM_ID") !== -1) {
          setMsg("Form endpoint is missing. Replace the Formspree action URL with your real Form ID.", "err");
          return;
        }

        var rid = (ridInput && ridInput.value) ? ridInput.value : "";
        var lane = "";
        try { lane = (new FormData(form).get("lane") || ""); } catch(e){}

        btn.disabled = true;
        btn.dataset.label = btn.textContent;
        btn.textContent = "Sending…";
        setMsg("Sending your intake…", "info");

        try {
          var fd = new FormData(form);
          var res = await fetch(action, { method: "POST", body: fd, headers: { "Accept": "application/json" } });

          if (!res.ok) {
            setMsg("Submission failed. Please try again.", "err");
            btn.disabled = false;
            btn.textContent = btn.dataset.label || "Submit intake & route";
            return;
          }

          setMsg("Submitted. Routing…", "ok");
          routeByLane(lane, rid);

        } catch (err) {
          setMsg("Network error. Please check your connection and try again.", "err");
          btn.disabled = false;
          btn.textContent = btn.dataset.label || "Submit intake & route";
        }
      });
    })();

    // Active state
    (function () {
      function normPath(p) {
        if (!p) return "/";
        p = p.split("?")[0].split("#")[0];
        if (p.length > 1 && p.endsWith("/")) p = p.slice(0, -1);
        return p.toLowerCase();
      }
      var current = normPath(window.location.pathname);
      var links = document.querySelectorAll('nav[aria-label="Primary navigation"] a, footer a, #mobilePanel a');

      links.forEach(function (a) {
        var href = a.getAttribute("href") || "";
        if (!href.startsWith("/")) return;
        var target = normPath(href);
        var isActive =
          (target === "/" && current === "/") ||
          (target !== "/" && (current === target || current.startsWith(target + "/")));
        if (isActive) {
          a.classList.add("active");
          a.setAttribute("aria-current", "page");
        } else {
          a.classList.remove("active");
          a.removeAttribute("aria-current");
        }
      });
    })();
  </script>
</body>
</html>
