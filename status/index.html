<!-- /status/index.html — Noetfield Status (Request ID) v3.2
     Upgrades:
     - Shell-consistent header/footer (nfHeader/nfFooter) + same hero treatment
     - Stronger boundary language + clearer “non-confidential” posture
     - Better RID hygiene: pattern hint, uppercase normalization, strict allowlist, Enter-to-check
     - Better UX: inline validation, deep-link (?rid=), copy/share, “open correct next step”
     - Cleaner track/lane inference + fewer duplicate storage reads
     - Accessible live region + focus management
-->
<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Noetfield — Status</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="description" content="Check Noetfield request status by Request ID. Board-ready routing and next-step updates—without exposing confidential data." />
  <meta name="robots" content="index,follow" />
  <meta name="author" content="Noetfield Systems Inc." />
  <meta name="theme-color" content="#07070b" />

  <link rel="canonical" href="https://www.noetfield.com/status/" />
  <link rel="icon" href="/noetfield-favicon-512.png" type="image/png" />
  <link rel="apple-touch-icon" href="/noetfield-favicon-512.png" />

  <!-- OG -->
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Noetfield" />
  <meta property="og:title" content="Noetfield — Status" />
  <meta property="og:description" content="Check Noetfield request status by Request ID." />
  <meta property="og:url" content="https://www.noetfield.com/status/" />
  <meta property="og:image" content="https://www.noetfield.com/noetfield-og.png" />

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Noetfield — Status" />
  <meta name="twitter:description" content="Check Noetfield request status by Request ID." />
  <meta name="twitter:image" content="https://www.noetfield.com/noetfield-og.png" />

  <!-- LOCKED SHELL -->
  <link rel="stylesheet" href="/assets/noetfield-shell.css" />
  <script src="/assets/noetfield-shell.js" defer></script>

  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebPage",
    "name":"Noetfield — Status",
    "url":"https://www.noetfield.com/status/",
    "description":"Check Noetfield request status by Request ID.",
    "isPartOf":{"@type":"WebSite","name":"Noetfield","url":"https://www.noetfield.com/"},
    "publisher":{"@type":"Organization","name":"Noetfield Systems Inc.","url":"https://www.noetfield.com/"}
  }
  </script>

  <style>
    .hero{padding:22px 0 14px}
    .heroShell{
      position:relative;
      border-radius: calc(var(--radius) + 8px);
      border: 1px solid rgba(255,255,255,.11);
      background:
        radial-gradient(1000px 420px at 18% 0%, rgba(200,163,73,.18), transparent 60%),
        radial-gradient(1000px 420px at 90% 10%, rgba(122,167,255,.10), transparent 62%),
        linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.022));
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .heroShell::before{
      content:"";
      position:absolute; inset:-1px;
      background: linear-gradient(120deg, rgba(200,163,73,.26), transparent 30%, rgba(255,255,255,.08) 68%, transparent);
      opacity:.44;
      pointer-events:none;
      mask-image: linear-gradient(180deg, black 0%, black 58%, transparent 96%);
    }
    .heroInner{padding: 24px 22px}

    .eyebrow{
      display:inline-flex; gap:10px; align-items:center;
      color:var(--muted);
      font-size:13px;
      padding:9px 12px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.13);
      background: rgba(255,255,255,.035);
    }
    .dot{
      width:8px; height:8px; border-radius:50%;
      background: rgba(200,163,73,.97);
      box-shadow: 0 0 0 3px rgba(200,163,73,.18);
    }

    h1{margin:14px 0 10px; font-size:40px; line-height:1.07; letter-spacing:-0.75px}
    .lead{margin:0; color:var(--muted); font-size:16px; max-width: 980px; line-height:1.75}
    .lead strong{color:var(--text); font-weight:900}

    .grid{
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap:18px;
      margin: 18px 0 34px;
      align-items:start;
    }
    .card{
      border-radius:var(--radius);
      border:1px solid rgba(255,255,255,.11);
      background: linear-gradient(180deg, rgba(255,255,255,.055), rgba(255,255,255,.022));
      box-shadow: var(--shadow2);
      overflow:hidden;
      min-width:0;
    }
    .card .hd{padding:18px 18px 0}
    .card h2{margin:0 0 8px; font-size:18px; letter-spacing:-0.2px}
    .card p{margin:0 0 12px; color:var(--muted); line-height:1.7}
    .card .bd{padding:18px}

    .ridBar{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      margin-top:12px;
      padding:12px 12px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      min-width:0;
    }
    .ridLabel{font-size:11px; letter-spacing:.28em; text-transform:uppercase; color:var(--muted2)}
    .ridValue{
      font-weight:750; color:var(--text); font-size:13px;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width:520px
    }
    .ridActions{display:flex; gap:8px; align-items:center; flex-wrap:wrap}
    .miniBtn{
      font-size:13px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.04);
      padding:9px 12px;
      border-radius:14px;
      cursor:pointer;
      display:inline-flex; align-items:center; justify-content:center; gap:8px;
      color: var(--text);
      text-decoration:none;
      user-select:none;
      transition: border-color .15s ease, background .15s ease, transform .06s ease;
      white-space:nowrap;
    }
    .miniBtn.primary{border-color: rgba(200,163,73,.38); background: rgba(200,163,73,.10)}
    .miniBtn:hover{border-color:rgba(255,255,255,.22); background:rgba(255,255,255,.06)}
    .miniBtn:active{transform: translateY(1px)}

    label{display:block; font-size:12px; color:var(--muted2); margin:0 0 6px}
    input{
      width:100%;
      background: rgba(10,10,16,.55);
      border: 1px solid rgba(255,255,255,.14);
      color: var(--text);
      padding: 12px 12px;
      border-radius: 14px;
      font-family:inherit;
      font-size:14px;
      transition: border-color .15s ease, box-shadow .15s ease, background .15s ease;
    }
    input::placeholder{color: rgba(185,187,207,.55)}
    input:focus{box-shadow: var(--focus); background: rgba(12,12,18,.62)}
    .hint{margin-top:8px; color:var(--muted2); font-size:12.5px; line-height:1.6}
    .hint code{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; font-size:12.5px}

    .actions{display:flex; gap:12px; flex-wrap:wrap; align-items:center; margin-top:12px}

    .msg{
      display:none;
      margin-top:12px;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.03);
      color: var(--muted);
      font-size:12.8px;
      line-height:1.6;
    }

    .box{
      margin-top:12px;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      color:var(--muted2);
      font-size:12.8px;
      line-height:1.6;
    }
    .box strong{color:var(--text); font-weight:900}
    .box a{border-bottom:1px solid rgba(255,255,255,.18)}

    .statusCard{
      margin-top:12px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      padding:14px;
    }
    .kRow{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      padding:10px 0;
      border-top:1px solid rgba(255,255,255,.08);
    }
    .kRow:first-child{border-top:0; padding-top:0}
    .kRow .k{color:var(--muted2); font-size:12px; letter-spacing:.12em; text-transform:uppercase; min-width:140px}
    .kRow .v{color:var(--text); font-size:13.6px; line-height:1.55; flex:1}

    .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.03);
      color:var(--muted);
      font-size:12px;
      white-space:nowrap;
    }
    .badge .bDot{
      width:8px; height:8px; border-radius:50%;
      background: rgba(200,163,73,.95);
      box-shadow: 0 0 0 3px rgba(200,163,73,.18);
    }
    .badge.ok .bDot{background: rgba(122,255,170,.95); box-shadow: 0 0 0 3px rgba(122,255,170,.16)}
    .badge.warn .bDot{background: rgba(255,205,90,.95); box-shadow: 0 0 0 3px rgba(255,205,90,.16)}
    .badge.err .bDot{background: rgba(255,90,90,.95); box-shadow: 0 0 0 3px rgba(255,90,90,.18)}

    .muted{color:var(--muted2)}
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}

    @media (max-width: 980px){
      .grid{grid-template-columns:1fr}
      .ridValue{max-width:100%}
    }
    @media (max-width: 760px){
      h1{font-size:30px}
      .ridBar{flex-direction:column; align-items:flex-start}
      .ridActions{width:100%}
      .ridActions .miniBtn{flex:1 1 auto}
      .kRow{flex-direction:column}
      .kRow .k{min-width:0}
    }
  </style>
</head>

<body>
  <div class="bg" aria-hidden="true"></div>
  <a class="skip" href="#main">Skip to content</a>

  <header id="nfHeader"></header>

  <main id="main" class="wrap">
    <section class="hero" aria-label="Status hero">
      <div class="heroShell">
        <div class="heroInner">
          <div class="eyebrow"><span class="dot"></span> Status • Request ID tracking</div>
          <h1>Track a request by Request ID.</h1>
          <p class="lead">
            Enter a <strong>Request ID</strong> to view high-level progress. This page is intentionally <strong>non-confidential</strong>:
            no internal assessments, documents, or sensitive details are shown.
          </p>
        </div>
      </div>
    </section>

    <section class="grid" aria-label="Status page grid">
      <!-- STATUS LOOKUP -->
      <section class="card" aria-label="Status lookup">
        <div class="hd">
          <h2>Status lookup</h2>
          <p>Paste your Request ID (example: <span class="mono">NF-G-YYYYMMDD-HHMMSS-1234</span>) and check.</p>

          <div class="ridBar" aria-label="Current Request ID bar">
            <div style="min-width:0">
              <div class="ridLabel">Current Request ID</div>
              <div class="ridValue mono" id="ridText">—</div>
            </div>
            <div class="ridActions" aria-label="RID actions">
              <button class="miniBtn" type="button" id="copyRidBtn">Copy</button>
              <button class="miniBtn" type="button" id="shareRidBtn">Share</button>
              <a class="miniBtn primary" id="openNextBtn" href="/gate/intake/">Open next step</a>
            </div>
          </div>
        </div>

        <div class="bd">
          <label for="ridInput">Request ID</label>
          <input
            id="ridInput"
            type="text"
            inputmode="latin"
            autocomplete="off"
            spellcheck="false"
            placeholder="NF-G-... or NF-P-..."
            aria-describedby="ridHelp"
          />
          <div class="hint" id="ridHelp">
            Accepts: letters/numbers/dash/underscore only. Suggested format: <code>NF-G-YYYYMMDD-HHMMSS-1234</code>.
          </div>

          <div class="actions" aria-label="Primary actions">
            <button class="btn" id="checkBtn" type="button">Check status</button>
            <button class="btn secondary" id="useSavedBtn" type="button">Use saved ID</button>
            <a class="btn secondary" href="/gate/">Back to Gate</a>
          </div>

          <div id="msg" class="msg" role="status" aria-live="polite"></div>

          <div class="statusCard" id="statusCard" hidden aria-label="Status result">
            <div class="kRow">
              <div class="k">Status</div>
              <div class="v">
                <span class="badge ok" id="badgeWrap">
                  <span class="bDot" aria-hidden="true"></span>
                  <span id="stBadge">Received</span>
                </span>
                <span class="muted" id="stTime" style="margin-left:10px;"></span>
              </div>
            </div>

            <div class="kRow">
              <div class="k">Track</div>
              <div class="v" id="stTrack">—</div>
            </div>

            <div class="kRow">
              <div class="k">Lane</div>
              <div class="v" id="stLane">—</div>
            </div>

            <div class="kRow">
              <div class="k">Next step</div>
              <div class="v" id="stNext">—</div>
            </div>

            <div class="kRow">
              <div class="k">Notes</div>
              <div class="v muted" id="stNotes">—</div>
            </div>
          </div>

          <div class="box">
            <strong>Important:</strong> Until a back-end status store is connected, this page shows a safe client-side preview:
            it confirms the Request ID and shows next-step routing based on stored Gate context (if available).
          </div>
        </div>
      </section>

      <!-- ASIDE -->
      <aside class="card" aria-label="How status works">
        <div class="hd">
          <h2>How Status works</h2>
          <p>What this page shows—and what it never shows.</p>
        </div>
        <div class="bd">
          <div class="box"><strong>Shows:</strong> Request ID, track/lane hints, and next-step links.</div>
          <div class="box"><strong>Never shows:</strong> internal assessments, client data, security details, or documents.</div>
          <div class="box"><strong>Lost the ID:</strong> re-submit via <a href="/gate/intake/">Intake directory</a> to generate a new Request ID.</div>

          <div class="box" style="margin-top:14px;">
            <strong>Links:</strong><br/>
            <a href="/gate/intake/">Intake</a> ·
            <a href="/gate/sales/">Purchase</a> ·
            <a href="/gate/partners/intake/">Partner intake</a> ·
            <a href="/privacy/">Privacy</a> ·
            <a href="/contact/">Contact</a>
          </div>
        </div>
      </aside>
    </section>
  </main>

  <footer id="nfFooter"></footer>

  <script>
    (function () {
      var $ = function(id){ return document.getElementById(id); };

      var ridText = $("ridText");
      var ridInput = $("ridInput");
      var copyBtn = $("copyRidBtn");
      var shareBtn = $("shareRidBtn");
      var openNextBtn = $("openNextBtn");

      var checkBtn = $("checkBtn");
      var useSavedBtn = $("useSavedBtn");

      var msg = $("msg");
      var card = $("statusCard");

      var badgeWrap = $("badgeWrap");
      var stBadge = $("stBadge");
      var stTime = $("stTime");
      var stTrack = $("stTrack");
      var stLane = $("stLane");
      var stNext = $("stNext");
      var stNotes = $("stNotes");

      var KEY_RID = "nf_gate_rid";
      var KEY_TRACK = "nf_gate_track";
      var KEY_LANE = "nf_gate_lane";

      function sanitizeRID(x){
        x = (x || "").trim();
        if (!x) return "";
        // allowlist: letters, numbers, dash, underscore
        x = x.replace(/[^a-zA-Z0-9\-_]/g, "");
        // normalize to uppercase for consistent display
        x = x.toUpperCase();
        return x.slice(0, 80);
      }

      function looksLikeRID(x){
        // permissive: must start with "NF-" and include at least two dashes
        if (!x) return false;
        if (!x.startsWith("NF-")) return false;
        var dashes = (x.match(/-/g) || []).length;
        return dashes >= 2 && x.length >= 10;
      }

      function setMsg(text, kind){
        if (!msg) return;
        msg.style.display = "block";
        msg.textContent = text;

        if (kind === "ok") {
          msg.style.borderColor = "rgba(45,227,138,.25)";
          msg.style.background = "rgba(45,227,138,.06)";
        } else if (kind === "err") {
          msg.style.borderColor = "rgba(255,90,90,.25)";
          msg.style.background = "rgba(255,90,90,.06)";
        } else if (kind === "warn") {
          msg.style.borderColor = "rgba(255,205,90,.25)";
          msg.style.background = "rgba(255,205,90,.06)";
        } else {
          msg.style.borderColor = "rgba(255,255,255,.12)";
          msg.style.background = "rgba(255,255,255,.03)";
        }
      }

      function setBadge(kind, text){
        if (!badgeWrap || !stBadge) return;
        badgeWrap.classList.remove("ok","warn","err");
        badgeWrap.classList.add(kind || "ok");
        stBadge.textContent = text || "Received";
      }

      function fallbackCopy(text){
        try{
          var ta = document.createElement("textarea");
          ta.value = text;
          ta.setAttribute("readonly","");
          ta.style.position = "fixed";
          ta.style.left = "-9999px";
          document.body.appendChild(ta);
          ta.select();
          document.execCommand("copy");
          document.body.removeChild(ta);
          return true;
        } catch(e){
          return false;
        }
      }

      function readLS(key){
        try { return (localStorage.getItem(key) || "").trim(); } catch(e){ return ""; }
      }
      function writeLS(key, val){
        try { localStorage.setItem(key, val); } catch(e){}
      }

      function getSavedRID(){
        // try a few known keys from earlier pages
        var candidates = [
          readLS("nf_gate_rid"),
          readLS("nf_partner_rid"),
          readLS("nf_gate_last_submitted_rid"),
          readLS("nf_partner_last_submitted_rid")
        ].map(sanitizeRID).filter(Boolean);
        return candidates[0] || "";
      }

      function deriveContext(){
        var track = (readLS("nf_gate_track") || readLS("nf_track") || "gate").toLowerCase();
        var lane = (readLS("nf_gate_lane") || readLS("nf_partner_lane") || "").toLowerCase();
        // normalize
        if (track === "partner") track = "partners";
        if (track === "vendors") track = "partners";
        return { track: track || "gate", lane: lane || "" };
      }

      function nextStepFor(track, lane){
        // partners
        if (track === "partners") {
          if (lane === "integration") return { text:"Open Partners Gate (Integration lane).", href:"/gate/partners/?lane=integration" };
          if (lane === "channel") return { text:"Open Partners Gate (Channel lane).", href:"/gate/partners/?lane=channel" };
          if (lane === "delivery") return { text:"Open Partners Gate (Delivery lane).", href:"/gate/partners/?lane=delivery" };
          return { text:"Open Partners Gate and select a lane.", href:"/gate/partners/" };
        }

        // product lanes (common)
        if (lane === "copilot-quickscan" || lane === "quickscan" || lane === "copilot") {
          return { text:"Open Copilot QuickScan intake (non-confidential).", href:"/copilot/quickscan/intake/" };
        }
        if (lane === "trust-brief") return { text:"Open Trust Brief intake or review scope.", href:"/trust-brief/intake/" };
        if (lane === "trust-ledger") return { text:"Open Trust Ledger intake or review scope.", href:"/trust-ledger/intake/" };

        // default
        return { text:"Open Intake directory to (re)submit and confirm routing.", href:"/gate/intake/" };
      }

      function setNextStep(track, lane, rid){
        var ns = nextStepFor(track, lane);

        if (openNextBtn) {
          // preserve rid for convenience (safe)
          var u = new URL(ns.href, window.location.origin);
          if (rid) u.searchParams.set("rid", rid);
          openNextBtn.href = u.pathname + (u.search ? u.search : "");
          openNextBtn.textContent = "Open next step";
        }

        if (stNext) {
          stNext.innerHTML = "";
          var a = document.createElement("a");
          a.href = ns.href;
          a.textContent = ns.text;
          stNext.appendChild(a);
        }
      }

      function render(rid){
        var ctx = deriveContext();
        var track = ctx.track;
        var lane = ctx.lane;

        if (ridText) ridText.textContent = rid || "—";

        if (stTime) stTime.textContent = "Updated: " + new Date().toLocaleString();
        if (stTrack) stTrack.textContent = track || "gate";
        if (stLane) stLane.textContent = lane ? lane : "—";

        setBadge("ok","Received");
        setNextStep(track, lane, rid);

        if (stNotes) {
          stNotes.textContent =
            "Back-end status store not yet connected. This view is a safe preview using your saved routing context (if present).";
        }

        if (card) card.hidden = false;

        setMsg("Request ID loaded. This page remains non-confidential by design.", "ok");
      }

      function setURLRID(rid){
        try{
          var u = new URL(window.location.href);
          if (rid) u.searchParams.set("rid", rid);
          else u.searchParams.delete("rid");
          window.history.replaceState({}, "", u.toString());
        } catch(e){}
      }

      function onCheck(){
        var rid = sanitizeRID(ridInput ? ridInput.value : "");
        if (!rid || !looksLikeRID(rid)) {
          setBadge("err","Invalid ID");
          if (card) card.hidden = true;
          setMsg("Enter a valid Request ID (must start with “NF-”).", "err");
          if (ridInput) ridInput.focus();
          return;
        }
        writeLS(KEY_RID, rid);
        setURLRID(rid);
        render(rid);
      }

      // init from query or storage
      var params;
      try { params = new URLSearchParams(window.location.search || ""); } catch(e){ params = null; }
      var rid = sanitizeRID(params ? params.get("rid") : "") || getSavedRID();

      if (ridInput) ridInput.value = rid || "";
      if (ridText) ridText.textContent = rid || "—";

      if (rid) render(rid);
      else setMsg("Paste a Request ID to view status. If no ID exists, submit via Intake to generate one.", "warn");

      if (checkBtn) checkBtn.addEventListener("click", onCheck);
      if (ridInput) {
        ridInput.addEventListener("keydown", function(e){
          if (e.key === "Enter") { e.preventDefault(); onCheck(); }
        });
        ridInput.addEventListener("input", function(){
          // live normalize (no cursor-jumps on every key: only sanitize on blur)
          if (!msg || msg.style.display === "none") return;
        });
        ridInput.addEventListener("blur", function(){
          var v = sanitizeRID(ridInput.value);
          if (v !== ridInput.value) ridInput.value = v;
        });
      }

      if (useSavedBtn) {
        useSavedBtn.addEventListener("click", function(){
          var saved = getSavedRID();
          if (!saved) {
            setBadge("warn","No saved ID");
            if (card) card.hidden = true;
            setMsg("No saved Request ID found. Submit via Intake to generate one.", "err");
            return;
          }
          if (ridInput) ridInput.value = saved;
          writeLS(KEY_RID, saved);
          setURLRID(saved);
          render(saved);
        });
      }

      if (copyBtn) {
        copyBtn.addEventListener("click", async function(){
          var x = sanitizeRID((ridInput && ridInput.value) ? ridInput.value : (ridText ? ridText.textContent : ""));
          if (!x || x === "—") { setMsg("No Request ID to copy.", "err"); return; }
          try{
            if (navigator.clipboard && navigator.clipboard.writeText) {
              await navigator.clipboard.writeText(x);
            } else {
              var ok = fallbackCopy(x);
              if (!ok) throw new Error("copy");
            }
            copyBtn.textContent = "Copied";
            setTimeout(function(){ copyBtn.textContent = "Copy"; }, 1200);
          } catch(e){
            copyBtn.textContent = "Copy failed";
            setTimeout(function(){ copyBtn.textContent = "Copy"; }, 1200);
          }
        });
      }

      if (shareBtn) {
        shareBtn.addEventListener("click", async function(){
          var x = sanitizeRID((ridInput && ridInput.value) ? ridInput.value : "");
          if (!x || !looksLikeRID(x)) { setMsg("Enter a valid Request ID to share.", "err"); return; }

          try{
            var u = new URL(window.location.origin + "/status/");
            u.searchParams.set("rid", x);

            if (navigator.share) {
              await navigator.share({
                title: "Noetfield — Status",
                text: "Noetfield request status (non-confidential) — Request ID: " + x,
                url: u.toString()
              });
              setMsg("Share opened. Only the Request ID is shared.", "ok");
            } else {
              // fallback: copy link
              var link = u.toString();
              if (navigator.clipboard && navigator.clipboard.writeText) await navigator.clipboard.writeText(link);
              else fallbackCopy(link);
              setMsg("Link copied. Only the Request ID is included.", "ok");
            }
          } catch(e){
            setMsg("Share cancelled or unavailable.", "warn");
          }
        });
      }
    })();
  </script>
</body>
</html>
